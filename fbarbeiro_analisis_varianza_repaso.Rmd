---
title: "Estadística Avanzada<br /><br /><u>Actividad 4</u><br /> <h2>Análisis de varianza y repaso del curso</h2>"
author: "Fernando Antonio Barbeiro Campos - fbarbeiro@uoc.edu"

date: '`r format(Sys.Date(),"%e %B, %Y")`<hr />'
output:
  html_document:
    toc: yes
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_libraries, include=FALSE}
library(knitr)
```

<hr />

## 1. Preprocesado
###1.1. Carga de datos
Cargar el fichero de datos “Fumadores.csv”.
```{r}
df <- read.csv("data/Fumadores.csv")
head(df)
```

###1.2. Tipos de datos
<p style="text-align: justify">Consultar los tipos de datos de las variables y si es necesario, aplicar las conversiones apropiadas. Averiguar posibles inconsistencias en los valores de Tipo o AE. En caso de que existan inconsitencias, corregidlas.
</p>
```{r}
# Buscando por valores NA
print(unlist(lapply(df, function(x) any(is.na(x)))))

# Reunindo los tipos de variables e imprimindo
res <- sapply(df, class)
kable(data.frame(variables=names(res),clase=as.vector(res)))

summary(df) # se nota (Other) en Tipo, deberíamos tener solo 6 categorías

unique(df$Tipo) # Claramente el problema ha sido detectado - 2 letras minusculas
df <- as.data.frame(sapply(df, toupper))
# Aunque va enseñar solo 2 decimales, R mantiene el número como él era inicialmente
df$AE <- as.numeric(as.character(df$AE))

print(head(df$AE))
str(df)
```

###1.3. Realizar un análisis descriptivo de la muestra en su totalidad en relación a la variable AE
Recordando que la estadística descriptiva se trata de resumir los datos de una muestra (en vez de extraer conclusiones).
```{r}
kable(summary(df)[,1], # 1 posicion AE
      digits=2, align='l', caption="Estadística descriptiva de la variable AE", col.names = "AE")
```

###1.4. Analizar los datos según el tipo de fumador
<p style="text-align: justify">
Mostrar el número de personas en cada tipo de fumador, la media de AE de cada tipo de fumador y un gráfico que muestre esta media. Se recomienda ordenar el gráfico de menos a más AE.
</p>
<p style="text-align: justify">
Luego, se debe representar un boxplot donde se muestre la distribución de AE por cada tipo. Para calcular la media o otras variables para cada tipo de fumador, podéis usar las funciones **summarize** y **group_by** de la libreria **dplyr** que os serán de gran utilidad. Para realizar la visualización de los datos, podéis usar la función **ggplot** de la librería **ggplot2**.
</p>
```{r}
library(plotrix) 
category <- table(df$Tipo)
lbls <- paste(names(category), "\n", category, sep="")
pie3D(category
      , radius=0.9
      , labelcex= 0.7
      , labels = lbls
      , explode=0.1
      , main="Distibución por Tipo de Fumador"
      , col = rainbow(length(lbls)
      ))

library(plyr)
r2 <- ddply(df, .(Tipo), summarize, 'Media'=mean(AE))
r2 <- r2[order(r2$Media),]
r2
plot(r2)
```
<hr />

## 2. Intervalo de confianza
## 3. Comparación de dos muestras: Fumadores vs No Fumadores
## 4. ANOVA
## 5. Comparaciones múltiples
## 6. ANOVA multifactorial
## 7. Aplicación de ANOVA a la investigación en minería de datos

